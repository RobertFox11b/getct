{
    "ps1_script": "#Connect to the Site\nConnect-PnPOnline -Url \"https://site.com/sites/site\" -UseWebLogin\n\n#Get All Lists\n$Lists = Get-PnPList -Includes RootFolder | Where-Object {$_.Hidden -eq $False}\n\n#Get content types of each list from the web\n$ContentTypeUsages = @()\n\nForEach ($List in $Lists) {\n    Write-Host -ForegroundColor Yellow \"Scanning List: $($List.Title)\"\n    $ListURL =  $List.RootFolder.ServerRelativeUrl\n\n    # Get all content types from the list\n    $ContentType = Get-PnPContentType -List $List | Where-Object {$_.Name -eq $ContentTypeName}\n\n    # Collect list details\n    If ($ContentType) {\n        $ContentTypeUsage = New-Object PSObject\n        $ContentTypeUsage | Add-Member -NotePropertyName \"SiteURL\" -NotePropertyValue \"https://site.com/sites/site\"\n        $ContentTypeUsage | Add-Member -NotePropertyName \"ListName\" -NotePropertyValue $List.Title\n        $ContentTypeUsage | Add-Member -NotePropertyName \"ListURL\" -NotePropertyValue $ListURL\n        $ContentTypeUsage | Add-Member -NotePropertyName \"ContentTypeName\" -NotePropertyValue $ContentType.Name\n        Write-Host -ForegroundColor Green \"`tFound the Content Type in Use!\"\n\n        # Export the result to CSV file\n        $ContentTypeUsage | Export-CSV $ReportOutput -NoTypeInformation -Append\n    }\n}\n\n# $reportoutput = 'C:\\Temp\\SharePoint_Content_TypesNew.csv'\n# $contenttypeusage | Export-CSV $ReportOutput -NoTypeInformation\n$ReportOutput = \"C:\\temp\\CT.csv\"\n$contenttypeusage = Get-PnpContentType -Identity \"Identity of Content Type\"\n$contenttypeusage | Export-CSV $ReportOutput -NoTypeInformation",
    "text_file": "# getct\nPowerShell Script to pull any Content Types from a given site along with associations\n\nThis is pretty straight forward. Simply change the two URLs to the URL of the site you want to investigate and also the path to the CSV file on the bottom of the page.\n\nThis was created because a customer appeared to have duplicate Document Sets that occurred during migration from SharePoint On-Premises 2013 to SharePoint Online (SPO).\n\nThe purpose of the script is to detect where the content type that cannot be deleted (due to it being in use) actually lives..."
  }
  